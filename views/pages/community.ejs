<%- include('../partials/header'), { account : account } %>
    <div id="body" class="wrapper" data-community-id="<%= community.id %>" data-community-title-id="<%= JSON.parse(community.title_ids)[0]; %>" data-community-title-id-hex="<%= JSON.parse(community.title_ids).map(titleId => Number(titleId).toString(16).padStart(16, '0')).join(',') %>"  data-community-title-name="<%= community.name %>">
            <header class="header">
                <% if (community.sub_communities.length != 0) { %>
                    <a data-pjax class="header-other-button" data-sound="SE_WAVE_OK_SUB" href="/communities/<%= community.id %>/other">Other Communities</a>
                <% } %>
                <h1 class="content-title title-label <%= (community.sub_communities.length !== 0) ? 'button-ellipsis' : '' %>"><%= community.name %></h1>
                <% if (!community.ingame_only) { %><a href="javascript:void(0)" class="add-post-button" onclick="wiiuSound.playSoundByName('SE_WAVE_OK', 3); aquamarine.openPostModal()">Post</a><% } %>
            </header>

            <div class="header-banner-container">
                <img src="../../../img/banners-wup/<%= community.id %>.jpg" class="banner-image">
            </div>

            <div class="community-info info-content with-header-banner">
                <span class="icon-container">
                    <img src="../../../img/icons/<%= community.id %>.jpg" class="icon">
                </span>
                <button data-sound="SE_WAVE_OK" class="settings-button button" onclick="aquamarine.openComSettingsModal()"></button>
                <button data-sound="" class="favorite-button button <%= (community.favorites.some(favorite => favorite.account_id == account[0].id)) ? "checked" : "" %>" onclick="aquamarine.toggleFavorite()"></button>
                <% if (community.type=="main" ) {%>
                    <span class="news-community-badge">Main Community</span>
                <%} else if (community.type=="sub" ) {%>
                    <span class="news-community-badge">Sub Community</span>
                <%} else if (community.type=="announcement" ) {%>
                    <span class="news-community-badge">Announcements Community</span>
                <%}%>
                    <span class="title"><%= ((community.name).toString().includes("Community")) ? community.name : community.name + " Community"  %></span>
                    <span class="text"><%= community.description %></span>
            </div>

            <div class="community-type" 
                data-tab-query="<%= posts.query %>" 
                data-scroll-event 
                data-scroll-container=".post-list" 
                data-scroll-url="/communities/<%= community.id %>" 
                data-scroll-tab>
                <a href="?type=topictag" data-tab-query="topictag" data-tab-context="community" class="tag_posts <%= (posts.query == "topictag") ? "selected" : "" %>">

                </a>
                <a href="?type=newest" data-tab-query="newest" data-tab-context="community" class="new_posts <%= (posts.query == "newest" || !posts.query) ? "selected" : "" %>">
                    <span>New Posts</span>
                </a>
                <a href="?type=played" data-tab-query="played" data-tab-context="community" class="player_posts  <%= (posts.query == "played") ? "selected" : "" %>" <%= (community.platform == "topic" || community.platform == "wii") ? "disabled" : "" %>>
                    <span>Player Posts</span>
                </a>
                <a href="?type=popular" data-tab-query="popular" data-tab-context="community" class="popular_posts  <%= (posts.query == "popular") ? "selected" : "" %>">
                    <span>Popular Posts</span>
                </a>
            </div>

            <div class="community-post-list">

                <div class="post-list" id="post_list">
                    <%- include("../partials/posts.ejs", {
                        posts : posts
                    }) %>
                </div>
                
                <a class="loading" id="loading" style="display: none;"></a>
            </div>

        <%- include("../partials/modal/screenshot-viewer.ejs") %>

        <%- include("../partials/modal/create_post.ejs") %>

        <%- include("../partials/modal/community-settings.ejs") %>
    </div>